def reencrypt(CT_k, rekey, mapping):            #proxy receive rekey generation from the data owner
    print("reencrypting...")
    sym_key, C, C_prime, C_i, policy_attrs, attr_weights, tau = CT_k
    C_j_prime = {}
    for A_i, A_j in mapping.items():            #look into the mapping attributes of different domain eg.{docter: researcher, level2: level3,...}
        if A_j in rekey and A_i in C_i:         # check if (researcher and level3) are in the "rekey" and (doctor and level2) are in the "C_i"
            D_i, K_i = rekey[A_j]
            C_j_prime[A_j] = C_i[A_i]           # Carry over original component to mapped name (kinda like change original C_i to C_j_prime)
    print("Re-encryption Successful")
    return (sym_key, C, C_prime, C_j_prime)     # return the CT_k_prime (the new CT_k)

CT_k = (b'z\x95c\x9d\xad\xec$l\xf8\xb8m\x829\xf2\xfa\xc3',
        [1641320184232521463359933466878501854985510160214469118987053147695548238533321835221931230194419393029325056370414825217987098395519904243127678002874862,
         669817034931913517074347903139488725036924007946310206408043997258276656113138611882820140284027228917592514566665032261564241174191118618798646858966969],
         [4992381980639293718841949183746217862077211116820790758062352843876736866574024923536799011276815277011084710700304422096620907388232045289698069056857997,
          3231360729509868165013731234691306814877918797680924913556188689037237878933289483193500294226999675422257435438814357609113217105649835085962475441456099],
          {'Doctor': [6062143122903601530205492060920251506629259023599539306327372583120932141885692501097546484816213610836840399438024901591547223357390488228126742634902573,
                      3675915007759089195057787313379175036035400992550632664774042314115510738855532658819448775352554111927314014035009242343086559586881007750430842838175129],
                      'Level2': [4945218370379846427695324007938485724444780742804450569581911584451193462698629415336233259528197265165576348373525076394507880900150537317610155804518134,
                                 8669364264995393086834088072093813052176996367014987331437236489206925950267919315545128850700936241174964779314881500717787093277958454668087975254644633]},
                                 ['Doctor', 'Level2'], {'Doctor': 4, 'Level2': 2}, 5)
ReKey = {'Researcher': ([5750407767800327507188945615209441027798336264621797935718585630974440570456881536300963718195579968958557972000180062266106078843054630544507446057440708,
                         3268479660903978033793398312365959793096061705483550435610698107702063673661140305815514877394002999139213994548364309917504308823420478373419381603430126],
                         [1821976946786714827230526409033545392848971100360016983632487847453909491166309860751936681844960678296861367623990818926498304960276250396800241112231674,
                          7105517205091985868439693535319141684758266774177254561020786202173890371505348560755805959571897176994873554928952098167867718492973328486315372761906186]),
                          'Level3': ([5476685873670268943948360195312878691958395474606613073648848308258569292029519201846524498589264179333139230797104461534850505517129957132818395202227719,
                                      2361178054854529871554345216905017585335169569795476803107208093003201199750662957966972866168682324585798860709209728033038134823868529059314730180509271],
                                      [5711953002472849489032219951387870347025165799004009600658166576371490818078090792032451150690861832966548146516392176387682118201144572725170993505444430,
                                       6841454466466481508760657855419843141549884509703981146488647634546883867924219526561419281363022858460821213590810942694000647365353120677511191006372956])}
mapping = {"Doctor": "Researcher", "Level2": "Level3"}
CT_k_prime = reencrypt(CT_k, ReKey, mapping)
